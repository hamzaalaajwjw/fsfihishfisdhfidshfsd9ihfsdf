<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Red Pill Platform</title>
  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700;800;900&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
  /* =====================================================
     GLOBAL / RESET
  ===================================================== */
  * {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
  }
  
  body {
    font-family: 'Cairo', sans-serif;
    background: #0a0a0b;
    color: #f0f0f0;
    overflow-x: hidden;
    line-height: 1.6;
  }
  
  h1, h2, h3, h4, h5, h6 {
    margin: 0;
    font-weight: 700;
  }
  
  button {
    cursor: pointer;
    font-family: inherit;
    border: none;
    outline: none;
  }
  
  a {
    text-decoration: none;
    color: inherit;
  }
  
  /* =====================================================
     THEME VARIABLES (PERFORMANCE FRIENDLY)
  ===================================================== */
  :root {
    --bg: #0a0a0b;
    --panel: #111114;
    --card: #1a1a1f;
    --card-hover: #202026;
    --border: #2a2a30;
    --accent: #e63946;
    --accent-light: #ff6b6b;
    --accent-dark: #c1121f;
    --secondary: #457b9d;
    --text: #f8f9fa;
    --text-muted: #a0a0a8;
    --text-light: #d4d4dc;
    --radius: 16px;
    --radius-sm: 10px;
    --transition: 0.25s cubic-bezier(0.4, 0, 0.2, 1);
    --shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
    --shadow-light: 0 5px 15px rgba(0, 0, 0, 0.2);
    --gradient: linear-gradient(135deg, #e63946 0%, #457b9d 100%);
  }
  
  /* =====================================================
     LAYOUT
  ===================================================== */
  header {
    height: 70px;
    background: linear-gradient(90deg, #0c0c0e, #111114);
    border-bottom: 1px solid var(--border);
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 0 30px;
    position: sticky;
    top: 0;
    z-index: 100;
    backdrop-filter: blur(10px);
    background-color: rgba(11, 11, 13, 0.9);
  }
  
  .logo {
    display: flex;
    align-items: center;
    gap: 12px;
    font-size: 24px;
    font-weight: 900;
    background: var(--gradient);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    letter-spacing: 0.5px;
  }
  
  .logo i {
    font-size: 22px;
  }
  
  .menu-toggle {
    display: none;
    background: none;
    color: var(--text);
    font-size: 24px;
    width: 50px;
    height: 50px;
    border-radius: var(--radius-sm);
    transition: all var(--transition);
  }
  
  .menu-toggle:hover {
    background: rgba(255, 255, 255, 0.05);
  }
  
  .app {
    display: flex;
    min-height: calc(100vh - 70px);
  }
  
  /* =====================================================
     SIDEBAR (HIDDEN BY DEFAULT ON MOBILE)
  ===================================================== */
  .sidebar {
    width: 320px;
    background: var(--panel);
    border-left: 1px solid var(--border);
    padding: 24px;
    display: flex;
    flex-direction: column;
    gap: 20px;
    position: relative;
    overflow-y: auto;
    max-height: calc(100vh - 70px);
    transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    z-index: 90;
  }
  
  .sidebar-overlay {
    display: none;
    position: fixed;
    top: 70px;
    right: 0;
    width: 100%;
    height: calc(100vh - 70px);
    background: rgba(0, 0, 0, 0.7);
    z-index: 80;
    backdrop-filter: blur(3px);
  }
  
  main {
    flex: 1;
    padding: 30px;
    max-width: 1200px;
    margin: 0 auto;
    width: 100%;
  }
  
  /* =====================================================
     UI COMPONENTS
  ===================================================== */
  .card {
    background: var(--card);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    padding: 24px;
    margin-bottom: 20px;
    transition: all var(--transition);
    box-shadow: var(--shadow-light);
  }
  
  .card:hover {
    transform: translateY(-5px);
    box-shadow: var(--shadow);
    border-color: #3a3a40;
  }
  
  .card.highlight {
    background: linear-gradient(145deg, #1c1c22, #151519);
    border-color: var(--accent);
    position: relative;
    overflow: hidden;
  }
  
  .card.highlight::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 4px;
    height: 100%;
    background: var(--gradient);
  }
  
  .btn {
    width: 100%;
    padding: 14px;
    border-radius: var(--radius-sm);
    border: none;
    background: var(--gradient);
    color: #fff;
    font-weight: 700;
    font-size: 16px;
    transition: all var(--transition);
    position: relative;
    overflow: hidden;
    z-index: 1;
  }
  
  .btn::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
    transition: 0.5s;
    z-index: -1;
  }
  
  .btn:hover::before {
    left: 100%;
  }
  
  .btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 20px rgba(230, 57, 70, 0.3);
  }
  
  .btn.ghost {
    background: transparent;
    border: 2px solid var(--border);
    color: var(--text-light);
  }
  
  .btn.ghost:hover {
    border-color: var(--accent);
    background: rgba(230, 57, 70, 0.05);
  }
  
  .btn.small {
    padding: 8px 16px;
    font-size: 14px;
    width: auto;
    border-radius: 8px;
  }
  
  .btn.danger {
    background: linear-gradient(135deg, #e63946 0%, #c1121f 100%);
  }
  
  .menu-item {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 14px 18px;
    background: transparent;
    color: var(--text-light);
    border-radius: var(--radius-sm);
    transition: all var(--transition);
    border: none;
    width: 100%;
    text-align: right;
    font-size: 16px;
  }
  
  .menu-item:hover {
    background: rgba(255, 255, 255, 0.05);
    color: var(--accent-light);
    transform: translateX(-5px);
  }
  
  .menu-item.active {
    background: rgba(230, 57, 70, 0.1);
    color: var(--accent-light);
    border-right: 3px solid var(--accent);
  }
  
  .menu-item i {
    width: 24px;
    font-size: 18px;
  }
  
  input, textarea, select {
    width: 100%;
    background: rgba(15, 15, 20, 0.8);
    border: 1px solid var(--border);
    border-radius: var(--radius-sm);
    padding: 12px 16px;
    color: #fff;
    margin-top: 8px;
    font-family: 'Cairo', sans-serif;
    transition: all var(--transition);
  }
  
  input:focus, textarea:focus, select:focus {
    outline: none;
    border-color: var(--accent);
    box-shadow: 0 0 0 3px rgba(230, 57, 70, 0.2);
  }
  
  .muted {
    color: var(--text-muted);
    font-size: 14px;
  }
  
  .tag {
    display: inline-block;
    padding: 4px 12px;
    background: rgba(69, 123, 157, 0.15);
    color: #8ecae6;
    border-radius: 20px;
    font-size: 12px;
    margin-left: 8px;
    margin-top: 8px;
  }
  
  .tag.hot {
    background: rgba(230, 57, 70, 0.15);
    color: #ff9a9e;
  }
  
  .tag.new {
    background: rgba(72, 187, 120, 0.15);
    color: #80ed99;
  }
  
  /* =====================================================
     CONTENT SECTIONS
  ===================================================== */
  .section-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 25px;
    flex-wrap: wrap;
    gap: 15px;
  }
  
  .section-title {
    font-size: 28px;
    background: var(--gradient);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
  }
  
  /* =====================================================
     ARTICLE
  ===================================================== */
  .article-title {
    font-size: 22px;
    font-weight: 800;
    margin-bottom: 8px;
    line-height: 1.4;
    color: var(--text);
  }
  
  .article-content {
    font-size: 16px;
    line-height: 1.7;
    margin: 16px 0;
    color: var(--text-light);
  }
  
  .article-meta {
    font-size: 14px;
    color: var(--text-muted);
    margin: 8px 0;
    display: flex;
    align-items: center;
    gap: 16px;
  }
  
  .article-meta i {
    margin-left: 5px;
  }
  
  .article-author {
    display: flex;
    align-items: center;
    gap: 8px;
    margin-top: 12px;
  }
  
  .article-actions {
    display: flex;
    gap: 24px;
    margin-top: 20px;
    font-size: 15px;
  }
  
  .action-btn {
    display: flex;
    align-items: center;
    gap: 8px;
    cursor: pointer;
    transition: all 0.2s;
    padding: 6px 0;
  }
  
  .action-btn:hover {
    color: var(--accent-light);
  }
  
  .action-btn.like {
    color: #ff6b6b;
  }
  
  .action-btn.like.active {
    color: #ff4757;
    font-weight: 700;
  }
  
  .action-btn.comment:hover {
    color: #8ecae6;
  }
  
  .action-btn.share:hover {
    color: #80ed99;
  }
  
  /* =====================================================
     PROFILE
  ===================================================== */
  .profile-header {
    display: flex;
    gap: 18px;
    align-items: center;
    margin-bottom: 20px;
  }
  
  .avatar {
    width: 80px;
    height: 80px;
    border-radius: 50%;
    background: linear-gradient(135deg, var(--accent), var(--secondary));
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 28px;
    font-weight: 800;
    color: white;
    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
  }
  
  .profile-stats {
    display: flex;
    gap: 30px;
    margin: 24px 0;
    padding: 20px;
    background: rgba(30, 30, 36, 0.5);
    border-radius: var(--radius);
  }
  
  .stat {
    text-align: center;
  }
  
  .stat-value {
    font-size: 28px;
    font-weight: 800;
    background: var(--gradient);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
  }
  
  .stat-label {
    font-size: 14px;
    color: var(--text-muted);
    margin-top: 4px;
  }
  
  /* =====================================================
     FILTERS & SORTING
  ===================================================== */
  .filters {
    display: flex;
    gap: 12px;
    margin-bottom: 24px;
    flex-wrap: wrap;
  }
  
  .filter-btn {
    padding: 10px 22px;
    background: var(--card);
    border: 1px solid var(--border);
    border-radius: 30px;
    color: var(--text-light);
    font-size: 15px;
    transition: all 0.2s;
    display: flex;
    align-items: center;
    gap: 8px;
  }
  
  .filter-btn.active {
    background: var(--accent);
    border-color: var(--accent);
    color: white;
  }
  
  .filter-btn:hover:not(.active) {
    border-color: var(--accent-light);
    color: var(--accent-light);
  }
  
  /* =====================================================
     MODALS
  ===================================================== */
  .modal-overlay {
    position: fixed;
    top: 0;
    right: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.85);
    display: none;
    align-items: center;
    justify-content: center;
    z-index: 1000;
    backdrop-filter: blur(8px);
  }
  
  .modal {
    background: var(--panel);
    border-radius: var(--radius);
    padding: 30px;
    width: 90%;
    max-width: 700px;
    border: 1px solid var(--border);
    box-shadow: 0 20px 50px rgba(0, 0, 0, 0.5);
    position: relative;
    animation: modalFadeIn 0.3s ease-out;
  }
  
  @keyframes modalFadeIn {
    from { opacity: 0; transform: translateY(30px); }
    to { opacity: 1; transform: translateY(0); }
  }
  
  .modal-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 24px;
  }
  
  .modal-close {
    background: none;
    color: var(--text-muted);
    font-size: 24px;
    width: 40px;
    height: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 50%;
  }
  
  .modal-close:hover {
    background: rgba(255, 255, 255, 0.05);
    color: var(--text);
  }
  
  /* =====================================================
     COMMENTS
  ===================================================== */
  .comments-section {
    margin-top: 30px;
    border-top: 1px solid var(--border);
    padding-top: 24px;
  }
  
  .comment {
    background: rgba(30, 30, 36, 0.5);
    border-radius: var(--radius-sm);
    padding: 16px;
    margin-top: 16px;
    border-left: 3px solid var(--secondary);
  }
  
  .comment-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 8px;
  }
  
  .comment-author {
    font-weight: 600;
    font-size: 15px;
  }
  
  .comment-time {
    font-size: 12px;
    color: var(--text-muted);
  }
  
  .comment-content {
    font-size: 15px;
    line-height: 1.6;
  }
  
  /* =====================================================
     LOADING & EMPTY STATES
  ===================================================== */
  .loading {
    display: flex;
    justify-content: center;
    align-items: center;
    padding: 60px;
  }
  
  .spinner {
    width: 50px;
    height: 50px;
    border: 5px solid rgba(255, 255, 255, 0.1);
    border-radius: 50%;
    border-top-color: var(--accent);
    animation: spin 1s ease-in-out infinite;
  }
  
  @keyframes spin {
    to { transform: rotate(360deg); }
  }
  
  .empty-state {
    text-align: center;
    padding: 60px 20px;
    color: var(--text-muted);
  }
  
  .empty-state i {
    font-size: 48px;
    margin-bottom: 16px;
    opacity: 0.5;
  }
  
  /* =====================================================
     NOTIFICATION
  ===================================================== */
  .notification {
    position: fixed;
    bottom: 30px;
    left: 30px;
    background: var(--panel);
    border-radius: var(--radius);
    padding: 16px 24px;
    border-left: 4px solid var(--accent);
    box-shadow: var(--shadow);
    display: none;
    align-items: center;
    gap: 12px;
    z-index: 1001;
    animation: slideIn 0.3s ease-out;
    max-width: 400px;
  }
  
  @keyframes slideIn {
    from { transform: translateX(-100%); opacity: 0; }
    to { transform: translateX(0); opacity: 1; }
  }
  
  .notification.success {
    border-left-color: #52b788;
  }
  
  .notification.error {
    border-left-color: #e63946;
  }
  
  /* =====================================================
     MOBILE RESPONSIVE
  ===================================================== */
  @media (max-width: 992px) {
    .menu-toggle {
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    .sidebar {
      position: fixed;
      top: 70px;
      right: 0;
      height: calc(100vh - 70px);
      transform: translateX(100%);
      z-index: 100;
      width: 320px;
      box-shadow: -10px 0 30px rgba(0, 0, 0, 0.5);
    }
    
    .sidebar.active {
      transform: translateX(0);
    }
    
    .sidebar-overlay.active {
      display: block;
    }
    
    main {
      padding: 20px;
      width: 100%;
    }
    
    .section-header {
      flex-direction: column;
      align-items: flex-start;
    }
    
    .profile-stats {
      gap: 20px;
      flex-wrap: wrap;
    }
    
    .modal {
      width: 95%;
      padding: 20px;
    }
  }
  
  @media (max-width: 576px) {
    header {
      padding: 0 20px;
      height: 60px;
    }
    
    .logo {
      font-size: 20px;
    }
    
    .sidebar {
      width: 280px;
    }
    
    .article-actions {
      gap: 16px;
      flex-wrap: wrap;
    }
    
    .filters {
      justify-content: center;
    }
    
    .notification {
      left: 20px;
      right: 20px;
      max-width: none;
    }
    
    .menu-item {
      padding: 12px 16px;
      font-size: 15px;
    }
  }
  </style>
</head>
<body>
  <header>
    <div class="logo">
      <i class="fas fa-pills"></i>
      <span>Red Pill Platform</span>
    </div>
    
    <button class="menu-toggle" id="menuToggle">
      <i class="fas fa-bars"></i>
    </button>
  </header>
  
  <div class="app">
    <!-- ================= SIDEBAR ================= -->
    <div class="sidebar" id="sidebar">
      <div id="authBox" class="card highlight"></div>
      
      <div class="card">
        <h4><i class="fas fa-sliders-h"></i> Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</h4>
        <div style="display: flex; flex-direction: column; gap: 8px; margin-top: 15px;">
          <button class="menu-item active" onclick="showSection('articles')">
            <i class="fas fa-newspaper"></i>
            <span>Ø§Ù„Ù…Ù‚Ø§Ù„Ø§Øª</span>
          </button>
          
          <button class="menu-item" onclick="showSection('profile')">
            <i class="fas fa-user-circle"></i>
            <span>Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ</span>
          </button>
          
          <button class="menu-item" onclick="showSection('myArticles')">
            <i class="fas fa-file-alt"></i>
            <span>Ù…Ù‚Ø§Ù„Ø§ØªÙŠ</span>
          </button>
          
          <button class="menu-item" onclick="showSection('stats')">
            <i class="fas fa-chart-bar"></i>
            <span>Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª</span>
          </button>
          
          <button class="menu-item" onclick="openPublishModal()">
            <i class="fas fa-pen-fancy"></i>
            <span>Ù†Ø´Ø± Ù…Ù‚Ø§Ù„ Ø¬Ø¯ÙŠØ¯</span>
          </button>
        </div>
      </div>
      
      <div class="card">
        <h4><i class="fas fa-info-circle"></i> Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ù†ØµØ©</h4>
        <div class="muted" style="margin-top: 10px; line-height: 1.8;">
          <p>Ù…Ø±Ø­Ø¨Ù‹Ø§ Ø¨ÙƒÙ… ÙÙŠ Ù…Ù†ØµØ© Red Pill Ù„Ù„ÙƒØªØ§Ø¨Ø© ÙˆØ§Ù„Ù…Ù‚Ø§Ù„Ø§Øª Ø§Ù„Ø­ØµØ±ÙŠØ©.</p>
          <p style="margin-top: 10px;">Ø´Ø§Ø±Ùƒ Ø£ÙÙƒØ§Ø±Ùƒ ÙˆØ§Ù‚Ø±Ø£ Ù…Ù‚Ø§Ù„Ø§Øª Ø§Ù„Ø¢Ø®Ø±ÙŠÙ† ÙÙŠ Ù…Ø¬ØªÙ…Ø¹ Ù…ØªÙƒØ§Ù…Ù„.</p>
        </div>
      </div>
    </div>
    
    <!-- Overlay for mobile sidebar -->
    <div class="sidebar-overlay" id="sidebarOverlay" onclick="toggleSidebar()"></div>
    
    <!-- ================= MAIN CONTENT ================= -->
    <main>
      <!-- Ù…Ù‚Ø§Ù„Ø§Øª Section (Default) -->
      <div id="articlesSection" class="content-section">
        <div class="section-header">
          <h2 class="section-title"><i class="fas fa-fire"></i> Ø§Ù„Ù…Ù‚Ø§Ù„Ø§Øª Ø§Ù„Ø´Ø§Ø¦Ø¹Ø©</h2>
          <div class="filters">
            <button class="filter-btn active" onclick="filterArticles('all')">
              <i class="fas fa-layer-group"></i> Ø§Ù„ÙƒÙ„
            </button>
            <button class="filter-btn" onclick="filterArticles('popular')">
              <i class="fas fa-fire"></i> Ø§Ù„Ø£ÙƒØ«Ø± Ø´Ø¹Ø¨ÙŠØ©
            </button>
            <button class="filter-btn" onclick="filterArticles('recent')">
              <i class="fas fa-clock"></i> Ø§Ù„Ø£Ø­Ø¯Ø«
            </button>
          </div>
        </div>
        
        <div id="articles" class="articles-container">
          <div class="loading" id="loadingArticles">
            <div class="spinner"></div>
          </div>
        </div>
      </div>
      
      <!-- Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ Section -->
      <div id="profileSection" class="content-section" style="display: none;">
        <div class="section-header">
          <h2 class="section-title"><i class="fas fa-user-circle"></i> Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ</h2>
          <button class="btn small ghost" onclick="showSection('articles')">
            <i class="fas fa-arrow-right"></i> Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ù…Ù‚Ø§Ù„Ø§Øª
          </button>
        </div>
        
        <div id="profileView"></div>
      </div>
      
      <!-- Ù…Ù‚Ø§Ù„Ø§ØªÙŠ Section -->
      <div id="myArticlesSection" class="content-section" style="display: none;">
        <div class="section-header">
          <h2 class="section-title"><i class="fas fa-file-alt"></i> Ù…Ù‚Ø§Ù„Ø§ØªÙŠ</h2>
          <button class="btn small ghost" onclick="showSection('articles')">
            <i class="fas fa-arrow-right"></i> Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ù…Ù‚Ø§Ù„Ø§Øª
          </button>
        </div>
        
        <div id="myArticlesView"></div>
      </div>
      
      <!-- Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Section -->
      <div id="statsSection" class="content-section" style="display: none;">
        <div class="section-header">
          <h2 class="section-title"><i class="fas fa-chart-bar"></i> Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ù…Ù†ØµØ©</h2>
          <button class="btn small ghost" onclick="showSection('articles')">
            <i class="fas fa-arrow-right"></i> Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ù…Ù‚Ø§Ù„Ø§Øª
          </button>
        </div>
        
        <div id="statsView" class="card highlight">
          <div class="loading" id="loadingStats">
            <div class="spinner"></div>
          </div>
        </div>
      </div>
    </main>
  </div>
  
  <!-- ================= PUBLISH MODAL ================= -->
  <div class="modal-overlay" id="publishModal">
    <div class="modal">
      <div class="modal-header">
        <h3><i class="fas fa-pen-fancy"></i> ÙƒØªØ§Ø¨Ø© Ù…Ù‚Ø§Ù„ Ø¬Ø¯ÙŠØ¯</h3>
        <button class="modal-close" onclick="closePublishModal()">
          <i class="fas fa-times"></i>
        </button>
      </div>
      
      <div class="modal-content">
        <label>Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…Ù‚Ø§Ù„</label>
        <input id="articleTitle" placeholder="Ø§ÙƒØªØ¨ Ø¹Ù†ÙˆØ§Ù†Ù‹Ø§ Ø¬Ø°Ø§Ø¨Ù‹Ø§ Ù„Ù…Ù‚Ø§Ù„Ùƒ">
        
        <label style="margin-top: 20px;">Ù†Øµ Ø§Ù„Ù…Ù‚Ø§Ù„</label>
        <textarea id="articleContent" placeholder="Ø§ÙƒØªØ¨ Ù…Ø­ØªÙˆÙ‰ Ù…Ù‚Ø§Ù„Ùƒ Ù‡Ù†Ø§..." rows="8"></textarea>
        
        <label style="margin-top: 20px;">Ø§Ù„ØªØµÙ†ÙŠÙ</label>
        <select id="articleCategory">
          <option value="Ø¹Ø§Ù…">Ø¹Ø§Ù…</option>
          <option value="ØªÙƒÙ†ÙˆÙ„ÙˆØ¬ÙŠØ§">ØªÙƒÙ†ÙˆÙ„ÙˆØ¬ÙŠØ§</option>
          <option value="ÙÙ„Ø³ÙØ©">ÙÙ„Ø³ÙØ©</option>
          <option value="Ø£Ø¯Ø¨">Ø£Ø¯Ø¨</option>
          <option value="Ø¹Ù„Ù…">Ø¹Ù„Ù…</option>
          <option value="ØªØ·ÙˆÙŠØ± Ø°Ø§ØªÙŠ">ØªØ·ÙˆÙŠØ± Ø°Ø§ØªÙŠ</option>
        </select>
        
        <button class="btn" style="margin-top: 30px;" onclick="publishArticle()">
          <i class="fas fa-paper-plane"></i> Ù†Ø´Ø± Ø§Ù„Ù…Ù‚Ø§Ù„
        </button>
      </div>
    </div>
  </div>
  
  <!-- ================= COMMENT MODAL ================= -->
  <div class="modal-overlay" id="commentModal">
    <div class="modal" style="max-width: 600px;">
      <div class="modal-header">
        <h3><i class="fas fa-comments"></i> Ø§Ù„ØªØ¹Ù„ÙŠÙ‚Ø§Øª</h3>
        <button class="modal-close" onclick="closeCommentModal()">
          <i class="fas fa-times"></i>
        </button>
      </div>
      
      <div class="modal-content">
        <div id="commentsList" style="max-height: 400px; overflow-y: auto;"></div>
        
        <div style="margin-top: 20px;">
          <textarea id="newComment" placeholder="Ø§ÙƒØªØ¨ ØªØ¹Ù„ÙŠÙ‚Ùƒ Ù‡Ù†Ø§..." rows="3"></textarea>
          <button class="btn small" onclick="postComment()" style="margin-top: 10px;">
            <i class="fas fa-paper-plane"></i> Ø¥Ø¶Ø§ÙØ© ØªØ¹Ù„ÙŠÙ‚
          </button>
        </div>
      </div>
    </div>
  </div>
  
  <!-- ================= NOTIFICATION ================= -->
  <div class="notification" id="notification">
    <i class="fas fa-check-circle" id="notificationIcon"></i>
    <span id="notificationText"></span>
  </div>

  <script type="module">
  /* =====================================================
     FIREBASE IMPORTS
  ===================================================== */
  import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
  import { getAuth, onAuthStateChanged, signInWithEmailAndPassword, createUserWithEmailAndPassword, signOut } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-auth.js";
  import { getDatabase, ref, push, onValue, update, get, set, remove, query, orderByChild, limitToLast } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-database.js";
  
  /* =====================================================
     CONFIG
  ===================================================== */
  const firebaseConfig = {
    apiKey: "AIzaSyCdoubvkI7VEvYxtG3CzKFAJg74XXl7fX4",
    authDomain: "redpill-1c7e2.firebaseapp.com",
    databaseURL: "https://redpill-1c7e2-default-rtdb.firebaseio.com",
    projectId: "redpill-1c7e2",
    storageBucket: "redpill-1c7e2.firebasestorage.app",
    messagingSenderId: "337690521778",
    appId: "1:337690521778:web:ba3c99ad55e6b0d58f59ab"
  };
  
  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);
  const db = getDatabase(app);
  
  // DOM Elements
  const authBox = document.getElementById('authBox');
  const articlesDiv = document.getElementById('articles');
  const profileView = document.getElementById('profileView');
  const myArticlesView = document.getElementById('myArticlesView');
  const statsView = document.getElementById('statsView');
  const publishModal = document.getElementById('publishModal');
  const commentModal = document.getElementById('commentModal');
  const notification = document.getElementById('notification');
  const menuToggle = document.getElementById('menuToggle');
  const sidebar = document.getElementById('sidebar');
  const sidebarOverlay = document.getElementById('sidebarOverlay');
  
  // Section elements
  const articlesSection = document.getElementById('articlesSection');
  const profileSection = document.getElementById('profileSection');
  const myArticlesSection = document.getElementById('myArticlesSection');
  const statsSection = document.getElementById('statsSection');
  
  // Global variables
  let currentUser = null;
  let currentArticleId = null;
  let currentFilter = 'all';
  let allArticles = [];
  
  /* =====================================================
     SIDEBAR FUNCTIONS
  ===================================================== */
  function toggleSidebar() {
    sidebar.classList.toggle('active');
    sidebarOverlay.classList.toggle('active');
  }
  
  menuToggle.addEventListener('click', toggleSidebar);
  
  // Close sidebar when clicking on overlay
  sidebarOverlay.addEventListener('click', toggleSidebar);
  
  // Close sidebar when clicking a menu item on mobile
  function closeSidebarOnMobile() {
    if (window.innerWidth <= 992) {
      toggleSidebar();
    }
  }
  
  /* =====================================================
     SECTION NAVIGATION
  ===================================================== */
  window.showSection = (sectionName) => {
    // Hide all sections
    articlesSection.style.display = 'none';
    profileSection.style.display = 'none';
    myArticlesSection.style.display = 'none';
    statsSection.style.display = 'none';
    
    // Remove active class from all menu items
    document.querySelectorAll('.menu-item').forEach(item => {
      item.classList.remove('active');
    });
    
    // Show selected section
    switch(sectionName) {
      case 'articles':
        articlesSection.style.display = 'block';
        document.querySelector('.menu-item:nth-child(1)').classList.add('active');
        loadArticles();
        break;
      case 'profile':
        profileSection.style.display = 'block';
        document.querySelector('.menu-item:nth-child(2)').classList.add('active');
        openProfile();
        break;
      case 'myArticles':
        myArticlesSection.style.display = 'block';
        document.querySelector('.menu-item:nth-child(3)').classList.add('active');
        openMyArticles();
        break;
      case 'stats':
        statsSection.style.display = 'block';
        document.querySelector('.menu-item:nth-child(4)').classList.add('active');
        loadStats();
        break;
    }
    
    // Close sidebar on mobile after selection
    closeSidebarOnMobile();
  };
  
  /* =====================================================
     AUTHENTICATION
  ===================================================== */
  onAuthStateChanged(auth, async (user) => {
    currentUser = user;
    
    if (user) {
      // User is logged in
      authBox.innerHTML = `
        <div class="profile-header">
          <div class="avatar">${user.email[0].toUpperCase()}</div>
          <div>
            <strong>${user.email.split('@')[0]}</strong>
            <div class="muted">Ø¹Ø¶Ùˆ Ù…Ø³Ø¬Ù„</div>
          </div>
        </div>
        <button class="btn ghost" id="logout" style="margin-top: 15px;">
          <i class="fas fa-sign-out-alt"></i> ØªØ³Ø¬ÙŠÙ„ Ø®Ø±ÙˆØ¬
        </button>
      `;
      
      document.getElementById('logout').onclick = () => signOut(auth);
      initProfile(user.uid);
      updateStats();
    } else {
      // User is not logged in
      authBox.innerHTML = `
        <h3><i class="fas fa-user"></i> ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</h3>
        <input id="email" placeholder="Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ">
        <input id="pass" type="password" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±" style="margin-top: 10px;">
        <button class="btn" id="login" style="margin-top: 15px;">
          <i class="fas fa-sign-in-alt"></i> Ø¯Ø®ÙˆÙ„
        </button>
        <button class="btn ghost" id="register" style="margin-top: 10px;">
          <i class="fas fa-user-plus"></i> Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨
        </button>
      `;
      
      document.getElementById('login').onclick = () => login();
      document.getElementById('register').onclick = () => register();
    }
    
    // Load articles by default
    loadArticles();
  });
  
  function login() {
    const email = document.getElementById('email').value;
    const pass = document.getElementById('pass').value;
    
    if (!email || !pass) {
      showNotification('ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„', 'error');
      return;
    }
    
    signInWithEmailAndPassword(auth, email, pass)
      .then(() => showNotification('ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ù†Ø¬Ø§Ø­', 'success'))
      .catch(e => showNotification(e.message, 'error'));
  }
  
  function register() {
    const email = document.getElementById('email').value;
    const pass = document.getElementById('pass').value;
    
    if (!email || !pass) {
      showNotification('ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„', 'error');
      return;
    }
    
    createUserWithEmailAndPassword(auth, email, pass)
      .then(() => showNotification('ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø­Ø³Ø§Ø¨ Ø¨Ù†Ø¬Ø§Ø­', 'success'))
      .catch(e => showNotification(e.message, 'error'));
  }
  
  /* =====================================================
     PROFILE SYSTEM
  ===================================================== */
  function initProfile(uid) {
    const userRef = ref(db, 'users/' + uid);
    get(userRef).then(snap => {
      if (!snap.exists()) {
        set(userRef, {
          username: `Ù…Ø³ØªØ®Ø¯Ù…_${Math.floor(Math.random() * 1000)}`,
          bio: 'Ù…Ø±Ø­Ø¨Ù‹Ø§! Ø£Ù†Ø§ Ù…Ø³ØªØ®Ø¯Ù… Ø¬Ø¯ÙŠØ¯ ÙÙŠ Red Pill Platform.',
          joinDate: Date.now(),
          articlesCount: 0,
          likesCount: 0
        });
      }
    });
  }
  
  async function openProfile() {
    if (!currentUser) {
      profileView.innerHTML = `
        <div class="card highlight">
          <div class="empty-state">
            <i class="fas fa-user-lock"></i>
            <h3>ÙŠØ¬Ø¨ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</h3>
            <p>Ø³Ø¬Ù„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù„Ø¹Ø±Ø¶ ÙˆØªØ¹Ø¯ÙŠÙ„ Ù…Ù„ÙÙƒ Ø§Ù„Ø´Ø®ØµÙŠ</p>
          </div>
        </div>
      `;
      return;
    }
    
    const snap = await get(ref(db, 'users/' + currentUser.uid));
    const userData = snap.val();
    
    // Get user's articles count
    const articlesSnap = await get(ref(db, 'articles'));
    let userArticlesCount = 0;
    articlesSnap.forEach(article => {
      if (article.val().author === currentUser.uid) {
        userArticlesCount++;
      }
    });
    
    // Get user's likes count
    let userLikesCount = 0;
    articlesSnap.forEach(article => {
      const likes = article.val().likesCount || 0;
      if (article.val().author === currentUser.uid) {
        userLikesCount += likes;
      }
    });
    
    profileView.innerHTML = `
      <div class="card highlight">
        <div class="profile-header">
          <div class="avatar">${currentUser.email[0].toUpperCase()}</div>
          <div>
            <h3>${userData.username || 'Ù…Ø³ØªØ®Ø¯Ù…'}</h3>
            <div class="muted">${currentUser.email}</div>
            <div class="muted">Ù…Ù†Ø° ${formatDate(userData.joinDate)}</div>
          </div>
        </div>
        
        <div class="profile-stats">
          <div class="stat">
            <div class="stat-value">${userArticlesCount}</div>
            <div class="stat-label">Ù…Ù‚Ø§Ù„Ø§Øª</div>
          </div>
          <div class="stat">
            <div class="stat-value">${userLikesCount}</div>
            <div class="stat-label">Ø¥Ø¹Ø¬Ø§Ø¨Ø§Øª</div>
          </div>
          <div class="stat">
            <div class="stat-value">0</div>
            <div class="stat-label">ØªØ¹Ù„ÙŠÙ‚Ø§Øª</div>
          </div>
        </div>
        
        <label>Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</label>
        <input id="p-name" value="${userData.username || ''}">
        
        <label style="margin-top: 15px;">Ù†Ø¨Ø°Ø© Ø¹Ù†Ùƒ</label>
        <textarea id="p-bio" rows="3">${userData.bio || ''}</textarea>
        
        <div style="display: flex; gap: 10px; margin-top: 20px;">
          <button class="btn small" onclick="saveProfile()">
            <i class="fas fa-save"></i> Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª
          </button>
          <button class="btn small ghost" onclick="showSection('articles')">
            <i class="fas fa-arrow-right"></i> Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ù…Ù‚Ø§Ù„Ø§Øª
          </button>
        </div>
      </div>
    `;
  }
  
  window.saveProfile = () => {
    const username = document.getElementById('p-name').value;
    const bio = document.getElementById('p-bio').value;
    
    if (!username.trim()) {
      showNotification('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… Ù…Ø³ØªØ®Ø¯Ù…', 'error');
      return;
    }
    
    update(ref(db, 'users/' + currentUser.uid), {
      username: username,
      bio: bio,
      updated: Date.now()
    }).then(() => {
      showNotification('ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ', 'success');
    });
  };
  
  /* =====================================================
     ARTICLES SYSTEM
  ===================================================== */
  function loadArticles() {
    articlesDiv.innerHTML = `
      <div class="loading" id="loadingArticles">
        <div class="spinner"></div>
      </div>
    `;
    
    const articlesRef = ref(db, 'articles');
    onValue(articlesRef, async (snap) => {
      articlesDiv.innerHTML = '';
      allArticles = [];
      
      if (!snap.exists()) {
        articlesDiv.innerHTML = `
          <div class="empty-state">
            <i class="fas fa-newspaper"></i>
            <h3>Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù‚Ø§Ù„Ø§Øª Ø¨Ø¹Ø¯</h3>
            <p>ÙƒÙ† Ø£ÙˆÙ„ Ù…Ù† ÙŠÙ†Ø´Ø± Ù…Ù‚Ø§Ù„Ù‹Ø§ Ø¹Ù„Ù‰ Ø§Ù„Ù…Ù†ØµØ©!</p>
            <button class="btn" onclick="openPublishModal()" style="margin-top: 20px; width: auto;">
              <i class="fas fa-pen-fancy"></i> Ù†Ø´Ø± Ø£ÙˆÙ„ Ù…Ù‚Ø§Ù„
            </button>
          </div>
        `;
        return;
      }
      
      // Convert to array
      snap.forEach(articleSnap => {
        allArticles.push({
          id: articleSnap.key,
          ...articleSnap.val()
        });
      });
      
      // Apply current filter
      let filteredArticles = [...allArticles];
      
      if (currentFilter === 'popular') {
        filteredArticles.sort((a, b) => (b.likesCount || 0) - (a.likesCount || 0));
      } else if (currentFilter === 'recent') {
        filteredArticles.sort((a, b) => b.created - a.created);
      } else {
        // 'all' - show all articles
        filteredArticles.sort((a, b) => b.created - a.created);
      }
      
      // Render each article
      for (const article of filteredArticles) {
        await renderArticle(article);
      }
      
      updateStats();
    });
  }
  
  window.filterArticles = (filterType) => {
    currentFilter = filterType;
    
    // Update active filter button
    document.querySelectorAll('.filter-btn').forEach(btn => {
      btn.classList.remove('active');
    });
    
    event.target.classList.add('active');
    
    // Reload articles with new filter
    loadArticles();
  };
  
  async function renderArticle(article) {
    const card = document.createElement('div');
    card.className = 'card';
    
    // Get author info
    let authorName = 'Ù…Ø¬Ù‡ÙˆÙ„';
    let authorInitial = '?';
    
    if (article.author) {
      const authorSnap = await get(ref(db, 'users/' + article.author));
      if (authorSnap.exists()) {
        authorName = authorSnap.val().username || 'Ù…Ø³ØªØ®Ø¯Ù…';
        authorInitial = authorName.charAt(0);
      }
    }
    
    // Check if current user liked this article
    let liked = false;
    if (currentUser) {
      const likeSnap = await get(ref(db, `likes/${article.id}/${currentUser.uid}`));
      liked = likeSnap.exists();
    }
    
    // Check if current user is the author
    const isAuthor = currentUser && article.author === currentUser.uid;
    
    // Add tags based on article properties
    let tagsHTML = '';
    if (article.likesCount > 10) {
      tagsHTML += '<span class="tag hot">ğŸ”¥ Ø´Ø§Ø¦Ø¹</span>';
    }
    
    if (Date.now() - article.created < 24 * 60 * 60 * 1000) {
      tagsHTML += '<span class="tag new">ğŸ†• Ø¬Ø¯ÙŠØ¯</span>';
    }
    
    if (article.category) {
      tagsHTML += `<span class="tag">${article.category}</span>`;
    }
    
    card.innerHTML = `
      <div class="article-title">${article.title}</div>
      ${tagsHTML}
      <div class="article-meta">
        <span><i class="far fa-calendar"></i> ${formatDate(article.created)}</span>
        <span><i class="far fa-user"></i> ${authorName}</span>
        <span><i class="far fa-eye"></i> ${Math.floor(Math.random() * 100) + 10} Ù…Ø´Ø§Ù‡Ø¯Ø©</span>
      </div>
      <div class="article-content">
        ${article.content.length > 200 ? article.content.substring(0, 200) + '...' : article.content}
      </div>
      <div class="article-actions">
        <div class="action-btn like ${liked ? 'active' : ''}" data-id="${article.id}" onclick="toggleLike('${article.id}', ${liked})">
          <i class="${liked ? 'fas' : 'far'} fa-heart"></i>
          <span>${article.likesCount || 0}</span>
        </div>
        <div class="action-btn comment" onclick="openComments('${article.id}')">
          <i class="far fa-comment"></i>
          <span>${article.commentsCount || 0}</span>
        </div>
        <div class="action-btn share" onclick="shareArticle('${article.id}', '${article.title}')">
          <i class="far fa-share-square"></i>
          <span>Ù…Ø´Ø§Ø±ÙƒØ©</span>
        </div>
        ${isAuthor ? `
        <div class="action-btn" style="color: #ff6b6b;" onclick="deleteArticle('${article.id}')">
          <i class="far fa-trash-alt"></i>
          <span>Ø­Ø°Ù</span>
        </div>
        ` : ''}
      </div>
    `;
    
    articlesDiv.appendChild(card);
  }
  
  /* =====================================================
     MY ARTICLES VIEW
  ===================================================== */
  async function openMyArticles() {
    if (!currentUser) {
      myArticlesView.innerHTML = `
        <div class="card highlight">
          <div class="empty-state">
            <i class="fas fa-user-lock"></i>
            <h3>ÙŠØ¬Ø¨ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</h3>
            <p>Ø³Ø¬Ù„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù„Ø¹Ø±Ø¶ Ù…Ù‚Ø§Ù„Ø§ØªÙƒ</p>
          </div>
        </div>
      `;
      return;
    }
    
    myArticlesView.innerHTML = `
      <div class="card highlight">
        <h3><i class="fas fa-newspaper"></i> Ù…Ù‚Ø§Ù„Ø§ØªÙŠ</h3>
        <div id="myArticlesList" style="margin-top: 20px;"></div>
      </div>
    `;
    
    const myArticlesList = document.getElementById('myArticlesList');
    myArticlesList.innerHTML = '<div class="loading"><div class="spinner"></div></div>';
    
    // Get user's articles
    const articlesSnap = await get(ref(db, 'articles'));
    const userArticles = [];
    
    articlesSnap.forEach(articleSnap => {
      const article = articleSnap.val();
      if (article.author === currentUser.uid) {
        userArticles.push({
          id: articleSnap.key,
          ...article
        });
      }
    });
    
    if (userArticles.length === 0) {
      myArticlesList.innerHTML = `
        <div class="empty-state">
          <i class="fas fa-newspaper"></i>
          <p>Ù„Ù… ØªÙ†Ø´Ø± Ø£ÙŠ Ù…Ù‚Ø§Ù„Ø§Øª Ø¨Ø¹Ø¯</p>
          <button class="btn small" onclick="openPublishModal()" style="margin-top: 15px;">
            <i class="fas fa-pen-fancy"></i> Ù†Ø´Ø± Ø£ÙˆÙ„ Ù…Ù‚Ø§Ù„
          </button>
        </div>
      `;
      return;
    }
    
    // Sort by date (newest first)
    userArticles.sort((a, b) => b.created - a.created);
    
    // Display user's articles
    userArticles.forEach(article => {
      const articleEl = document.createElement('div');
      articleEl.className = 'card';
      articleEl.style.marginBottom = '15px';
      
      articleEl.innerHTML = `
        <div style="display: flex; justify-content: space-between; align-items: center;">
          <div>
            <strong>${article.title}</strong>
            <div class="muted" style="margin-top: 5px;">
              ${formatDate(article.created)} â€¢ ${article.likesCount || 0} Ø¥Ø¹Ø¬Ø§Ø¨ â€¢ ${article.commentsCount || 0} ØªØ¹Ù„ÙŠÙ‚
            </div>
          </div>
          <div>
            <button class="btn small danger" onclick="deleteArticle('${article.id}')">
              <i class="far fa-trash-alt"></i> Ø­Ø°Ù
            </button>
          </div>
        </div>
      `;
      
      myArticlesList.appendChild(articleEl);
    });
  }
  
  /* =====================================================
     STATS VIEW
  ===================================================== */
  async function loadStats() {
    statsView.innerHTML = '<div class="loading"><div class="spinner"></div></div>';
    
    // Get articles count
    const articlesSnap = await get(ref(db, 'articles'));
    const articlesCount = articlesSnap.exists() ? articlesSnap.size : 0;
    
    // Get users count
    const usersSnap = await get(ref(db, 'users'));
    const usersCount = usersSnap.exists() ? usersSnap.size : 0;
    
    // Calculate total likes
    let totalLikes = 0;
    if (articlesSnap.exists()) {
      articlesSnap.forEach(article => {
        totalLikes += article.val().likesCount || 0;
      });
    }
    
    // Calculate total comments
    let totalComments = 0;
    if (articlesSnap.exists()) {
      articlesSnap.forEach(article => {
        totalComments += article.val().commentsCount || 0;
      });
    }
    
    statsView.innerHTML = `
      <div class="profile-stats">
        <div class="stat">
          <div class="stat-value">${articlesCount}</div>
          <div class="stat-label">Ù…Ù‚Ø§Ù„Ø§Øª</div>
        </div>
        <div class="stat">
          <div class="stat-value">${usersCount}</div>
          <div class="stat-label">Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</div>
        </div>
        <div class="stat">
          <div class="stat-value">${totalLikes}</div>
          <div class="stat-label">Ø¥Ø¹Ø¬Ø§Ø¨Ø§Øª</div>
        </div>
        <div class="stat">
          <div class="stat-value">${totalComments}</div>
          <div class="stat-label">ØªØ¹Ù„ÙŠÙ‚Ø§Øª</div>
        </div>
      </div>
      
      <h4 style="margin-top: 30px;"><i class="fas fa-chart-line"></i> Ù†Ø´Ø§Ø· Ø§Ù„Ù…Ù†ØµØ©</h4>
      <div class="muted" style="margin-top: 15px; line-height: 1.8;">
        <p>â€¢ ØªÙ… Ù†Ø´Ø± ${articlesCount} Ù…Ù‚Ø§Ù„ Ù…Ù†Ø° Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù…Ù†ØµØ©</p>
        <p>â€¢ ÙŠÙˆØ¬Ø¯ ${usersCount} Ù…Ø³ØªØ®Ø¯Ù… Ù…Ø³Ø¬Ù„ ÙÙŠ Ø§Ù„Ù…Ù†ØµØ©</p>
        <p>â€¢ Ø­ØµÙ„Øª Ø§Ù„Ù…Ù‚Ø§Ù„Ø§Øª Ø¹Ù„Ù‰ ${totalLikes} Ø¥Ø¹Ø¬Ø§Ø¨ Ø¥Ø¬Ù…Ø§Ù„Ø§Ù‹</p>
        <p>â€¢ ØªÙ… ÙƒØªØ§Ø¨Ø© ${totalComments} ØªØ¹Ù„ÙŠÙ‚ Ø¹Ù„Ù‰ Ø§Ù„Ù…Ù‚Ø§Ù„Ø§Øª</p>
      </div>
      
      <div style="margin-top: 30px;">
        <button class="btn small ghost" onclick="showSection('articles')">
          <i class="fas fa-arrow-right"></i> ØªØµÙØ­ Ø§Ù„Ù…Ù‚Ø§Ù„Ø§Øª
        </button>
      </div>
    `;
  }
  
  /* =====================================================
     PUBLISH ARTICLE
  ===================================================== */
  window.openPublishModal = () => {
    if (!currentUser) {
      showNotification('ÙŠØ¬Ø¨ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø£ÙˆÙ„Ø§Ù‹', 'error');
      return;
    }
    
    publishModal.style.display = 'flex';
    document.getElementById('articleTitle').focus();
    closeSidebarOnMobile();
  };
  
  window.closePublishModal = () => {
    publishModal.style.display = 'none';
    // Clear form
    document.getElementById('articleTitle').value = '';
    document.getElementById('articleContent').value = '';
    document.getElementById('articleCategory').value = 'Ø¹Ø§Ù…';
  };
  
  window.publishArticle = () => {
    const title = document.getElementById('articleTitle').value.trim();
    const content = document.getElementById('articleContent').value.trim();
    const category = document.getElementById('articleCategory').value;
    
    if (!title || !content) {
      showNotification('ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„', 'error');
      return;
    }
    
    push(ref(db, 'articles'), {
      title: title,
      content: content,
      category: category,
      author: currentUser.uid,
      created: Date.now(),
      likesCount: 0,
      commentsCount: 0
    }).then(() => {
      showNotification('ØªÙ… Ù†Ø´Ø± Ø§Ù„Ù…Ù‚Ø§Ù„ Ø¨Ù†Ø¬Ø§Ø­', 'success');
      closePublishModal();
      showSection('articles');
      
      // Update user's articles count
      const userRef = ref(db, 'users/' + currentUser.uid);
      get(userRef).then(snap => {
        const userData = snap.val() || {};
        const currentCount = userData.articlesCount || 0;
        update(userRef, { articlesCount: currentCount + 1 });
      });
    }).catch(error => {
      showNotification(error.message, 'error');
    });
  };
  
  /* =====================================================
     LIKES SYSTEM
  ===================================================== */
  window.toggleLike = async (articleId, liked) => {
    if (!currentUser) {
      showNotification('ÙŠØ¬Ø¨ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø£ÙˆÙ„Ø§Ù‹', 'error');
      return;
    }
    
    if (liked) return; // Already liked
    
    const likeRef = ref(db, `likes/${articleId}/${currentUser.uid}`);
    const articleRef = ref(db, `articles/${articleId}`);
    
    // Add like
    await set(likeRef, true);
    
    // Update likes count
    const articleSnap = await get(articleRef);
    const articleData = articleSnap.val();
    const newLikesCount = (articleData.likesCount || 0) + 1;
    
    await update(articleRef, { likesCount: newLikesCount });
    
    // Update UI
    const likeBtn = document.querySelector(`.like[data-id="${articleId}"]`);
    if (likeBtn) {
      likeBtn.classList.add('active');
      likeBtn.innerHTML = `<i class="fas fa-heart"></i><span>${newLikesCount}</span>`;
    }
    
    // Update user's likes count
    const userRef = ref(db, 'users/' + currentUser.uid);
    get(userRef).then(snap => {
      const userData = snap.val() || {};
      const currentLikes = userData.likesCount || 0;
      update(userRef, { likesCount: currentLikes + 1 });
    });
  };
  
  /* =====================================================
     COMMENTS SYSTEM
  ===================================================== */
  window.openComments = (articleId) => {
    if (!currentUser) {
      showNotification('ÙŠØ¬Ø¨ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø£ÙˆÙ„Ø§Ù‹', 'error');
      return;
    }
    
    currentArticleId = articleId;
    commentModal.style.display = 'flex';
    loadComments(articleId);
  };
  
  window.closeCommentModal = () => {
    commentModal.style.display = 'none';
    document.getElementById('newComment').value = '';
  };
  
  async function loadComments(articleId) {
    const commentsList = document.getElementById('commentsList');
    commentsList.innerHTML = '<div class="loading"><div class="spinner"></div></div>';
    
    const commentsRef = ref(db, `comments/${articleId}`);
    const commentsSnap = await get(commentsRef);
    
    commentsList.innerHTML = '';
    
    if (!commentsSnap.exists()) {
      commentsList.innerHTML = `
        <div class="empty-state">
          <i class="far fa-comments"></i>
          <p>Ù„Ø§ ØªÙˆØ¬Ø¯ ØªØ¹Ù„ÙŠÙ‚Ø§Øª Ø¨Ø¹Ø¯</p>
          <p class="muted">ÙƒÙ† Ø£ÙˆÙ„ Ù…Ù† ÙŠØ¹Ù„Ù‚ Ø¹Ù„Ù‰ Ù‡Ø°Ø§ Ø§Ù„Ù…Ù‚Ø§Ù„</p>
        </div>
      `;
      return;
    }
    
    const comments = [];
    commentsSnap.forEach(commentSnap => {
      comments.push({
        id: commentSnap.key,
        ...commentSnap.val()
      });
    });
    
    // Sort by date (newest first)
    comments.sort((a, b) => b.created - a.created);
    
    // Display comments
    for (const comment of comments) {
      const commentEl = document.createElement('div');
      commentEl.className = 'comment';
      
      // Get author info
      let authorName = 'Ù…Ø¬Ù‡ÙˆÙ„';
      if (comment.author) {
        const authorSnap = await get(ref(db, 'users/' + comment.author));
        if (authorSnap.exists()) {
          authorName = authorSnap.val().username || 'Ù…Ø³ØªØ®Ø¯Ù…';
        }
      }
      
      commentEl.innerHTML = `
        <div class="comment-header">
          <div class="comment-author">${authorName}</div>
          <div class="comment-time">${formatDate(comment.created)}</div>
        </div>
        <div class="comment-content">${comment.text}</div>
      `;
      
      commentsList.appendChild(commentEl);
    }
  }
  
  window.postComment = async () => {
    const commentText = document.getElementById('newComment').value.trim();
    
    if (!commentText) {
      showNotification('ÙŠØ±Ø¬Ù‰ ÙƒØªØ§Ø¨Ø© ØªØ¹Ù„ÙŠÙ‚', 'error');
      return;
    }
    
    const commentRef = ref(db, `comments/${currentArticleId}`);
    const articleRef = ref(db, `articles/${currentArticleId}`);
    
    // Add comment
    await push(commentRef, {
      text: commentText,
      author: currentUser.uid,
      created: Date.now()
    });
    
    // Update comments count
    const articleSnap = await get(articleRef);
    const articleData = articleSnap.val();
    const newCommentsCount = (articleData.commentsCount || 0) + 1;
    
    await update(articleRef, { commentsCount: newCommentsCount });
    
    // Clear input and reload comments
    document.getElementById('newComment').value = '';
    loadComments(currentArticleId);
    
    showNotification('ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„ØªØ¹Ù„ÙŠÙ‚', 'success');
  };
  
  /* =====================================================
     DELETE ARTICLE
  ===================================================== */
  window.deleteArticle = async (articleId) => {
    if (!confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ù…Ù‚Ø§Ù„ØŸ')) return;
    
    const articleRef = ref(db, `articles/${articleId}`);
    
    // Delete article
    await remove(articleRef);
    
    // Delete associated likes
    const likesRef = ref(db, `likes/${articleId}`);
    await remove(likesRef);
    
    // Delete associated comments
    const commentsRef = ref(db, `comments/${articleId}`);
    await remove(commentsRef);
    
    showNotification('ØªÙ… Ø­Ø°Ù Ø§Ù„Ù…Ù‚Ø§Ù„', 'success');
    
    // Reload current view
    if (articlesSection.style.display === 'block') {
      loadArticles();
    } else if (myArticlesSection.style.display === 'block') {
      openMyArticles();
    }
  };
  
  /* =====================================================
     SHARE ARTICLE
  ===================================================== */
  window.shareArticle = (articleId, articleTitle) => {
    const shareUrl = `${window.location.origin}${window.location.pathname}?article=${articleId}`;
    const shareText = `Ø§Ù‚Ø±Ø£ Ù…Ù‚Ø§Ù„ "${articleTitle}" Ø¹Ù„Ù‰ Red Pill Platform`;
    
    if (navigator.share) {
      navigator.share({
        title: articleTitle,
        text: shareText,
        url: shareUrl
      });
    } else {
      // Fallback: copy to clipboard
      navigator.clipboard.writeText(shareUrl).then(() => {
        showNotification('ØªÙ… Ù†Ø³Ø® Ø±Ø§Ø¨Ø· Ø§Ù„Ù…Ù‚Ø§Ù„', 'success');
      });
    }
  };
  
  /* =====================================================
     UTILITY FUNCTIONS
  ===================================================== */
  function formatDate(timestamp) {
    const date = new Date(timestamp);
    const now = new Date();
    const diff = now - date;
    
    // Less than a minute
    if (diff < 60 * 1000) {
      return 'Ø§Ù„Ø¢Ù†';
    }
    
    // Less than an hour
    if (diff < 60 * 60 * 1000) {
      const minutes = Math.floor(diff / (60 * 1000));
      return `Ù…Ù†Ø° ${minutes} Ø¯Ù‚ÙŠÙ‚Ø©`;
    }
    
    // Less than a day
    if (diff < 24 * 60 * 60 * 1000) {
      const hours = Math.floor(diff / (60 * 60 * 1000));
      return `Ù…Ù†Ø° ${hours} Ø³Ø§Ø¹Ø©`;
    }
    
    // Less than a week
    if (diff < 7 * 24 * 60 * 60 * 1000) {
      const days = Math.floor(diff / (24 * 60 * 60 * 1000));
      return `Ù…Ù†Ø° ${days} ÙŠÙˆÙ…`;
    }
    
    // Otherwise, show full date
    return date.toLocaleDateString('ar-SA', {
      year: 'numeric',
      month: 'long',
      day: 'numeric'
    });
  }
  
  function showNotification(message, type = 'success') {
    const icon = document.getElementById('notificationIcon');
    const text = document.getElementById('notificationText');
    
    // Set icon based on type
    if (type === 'success') {
      icon.className = 'fas fa-check-circle';
      notification.classList.add('success');
      notification.classList.remove('error');
    } else {
      icon.className = 'fas fa-exclamation-circle';
      notification.classList.add('error');
      notification.classList.remove('success');
    }
    
    text.textContent = message;
    notification.style.display = 'flex';
    
    // Auto hide after 5 seconds
    setTimeout(() => {
      notification.style.display = 'none';
    }, 5000);
  }
  
  async function updateStats() {
    // Update stats in sidebar
    const articlesSnap = await get(ref(db, 'articles'));
    const articlesCount = articlesSnap.exists() ? articlesSnap.size : 0;
    
    const usersSnap = await get(ref(db, 'users'));
    const usersCount = usersSnap.exists() ? usersSnap.size : 0;
    
    // Update stats view if it's currently visible
    if (statsSection.style.display === 'block') {
      loadStats();
    }
  }
  
  // Close modals when clicking outside
  window.addEventListener('click', (e) => {
    if (e.target === publishModal) {
      closePublishModal();
    }
    
    if (e.target === commentModal) {
      closeCommentModal();
    }
  });
  
  // Close notification when clicked
  notification.addEventListener('click', () => {
    notification.style.display = 'none';
  });
  
  // Close sidebar when pressing ESC key
  document.addEventListener('keydown', (e) => {
    if (e.key === 'Escape') {
      if (sidebar.classList.contains('active')) {
        toggleSidebar();
      }
    }
  });
  
  // Initial stats update
  updateStats();
  
  // Load articles by default
  window.showSection('articles');
  </script>
</body>
</html>
